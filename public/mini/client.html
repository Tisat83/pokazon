<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>mini client</title>

  <!-- Мы встраиваемся в iframe, нужна только клиентская часть -->
  <script>
    window.POKAZON_EMBED = true;
    window.POKAZON_ONLY  = 'client';
    if (location.hash !== '#help') { location.replace(location.pathname + '#help'); }
  </script>

  <!-- Лоадер (версию меняем для сброса кэша) -->
  <script defer src="/src/oko-loader.js?v=embed8"></script>

  <style>
    /* ===== демо-фон и прокрутка ===== */
    html, body {
      height: 100%;
    }
    body {
      margin: 0;
      /* одна (!) картинка фоном: */
      background-image: url('/assets/screen2.jpg');
      background-repeat: no-repeat;
      background-position: top center;
      /* растягиваем ширину до фрейма, по высоте — пропорционально */
      background-size: 100% auto;
      /* делаем вертикальную прокрутку, чтобы можно было «проскроллить» фон */
      overflow-y: auto;
      /* немного «контента» ниже, чтобы появилась зона прокрутки */
      padding-bottom: 1200px; /* можно подрегулировать, если нужно больше/меньше скролла */
    }

    /* кнопка «Подключить» (из виджета) должна быть поверх */
    .oko-widget-button {
      position: fixed !important;
      right: 18px;
      bottom: 18px;
      z-index: 2147483000; /* выше всего */
    }
  </style>

  <!-- Подстраховка: если вдруг где-то вылезет кнопка оператора — сносим её -->
  <script>
    (function () {
      function nuke() {
        document.querySelectorAll(
          '[data-oko="operator"], [data-oko-role="operator-toggle"], ' +
          '.oko-operator, #oko-operator, button, a'
        ).forEach(function(el){
          var t = (el.textContent||'').trim();
          if (t === 'ОКО Оператор') el.remove();
        });
      }
      nuke();
      var mo = new MutationObserver(nuke);
      mo.observe(document.documentElement, { childList:true, subtree:true });
      setTimeout(function(){ try { mo.disconnect(); } catch(e){} }, 2000);
    })();
  </script>
</head>
<body>
  <!-- Никаких <img> с фоном не вставляем! Фон задаётся только CSS-ом выше. -->
  <script>
/** уменьшение шага прокрутки в мини-демо (картинка) */
(function () {
  // 0.3 = 30% от системного шага; сделайте 0.2–0.35 как вам удобно
  const FACTOR = 0.30;

  // что крутим: либо спец-обёртка, либо сам документ
  const scroller =
    document.querySelector('.demo-scroll, .scroll, .frame, .page') ||
    document.scrollingElement || document.documentElement;

  // колесо
  function onWheel(e) {
    if (e.ctrlKey) return;           // не мешаем zoom по Ctrl+колесо
    e.preventDefault();              // берём прокрутку на себя
    scroller.scrollTop += e.deltaY * FACTOR;
  }
  window.addEventListener('wheel', onWheel, { passive: false });

  // PgUp / PgDn / стрелки (опционально)
  window.addEventListener('keydown', function (e) {
    const h = window.innerHeight;
    if (e.key === 'PageDown') { e.preventDefault(); scroller.scrollTop += h * FACTOR; }
    if (e.key === 'PageUp')   { e.preventDefault(); scroller.scrollTop -= h * FACTOR; }
    if (e.key === 'ArrowDown'){ e.preventDefault(); scroller.scrollTop += 60 * FACTOR; }
    if (e.key === 'ArrowUp')  { e.preventDefault(); scroller.scrollTop -= 60 * FACTOR; }
  });
})();
</script>

</body>
</html>
