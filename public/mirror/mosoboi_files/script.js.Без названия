$(function(){
		$('.item_btns div').click(function(){
		    obj=$(this);
		    num=obj.index();
		    obj_s=$('.tab');
		    if (obj.hasClass('active')) {
		    return;
		    }
		    else {
		    $('.item_btns div').removeClass('active');
		    obj.addClass('active');
		    obj_s.hide();
		    obj_s.eq(num).toggle();
		    }
		  });


		$('.item_btns-podbor div').click(function(){
		    obj=$(this);
		    num=obj.index();
		    obj_s=$('.tab2');
		    if (obj.hasClass('active')) {
		    return;
		    }
		    else {
		    $('.item_btns-podbor div').removeClass('active');
		    obj.addClass('active');
		    obj_s.hide();
		    obj_s.eq(num).toggle();
		    }
		  });

		$('.item_btns-map div').click(function(){
		    obj=$(this);
		    num=obj.index();
		    obj_s=$('.tab3');
		    if (obj.hasClass('active')) {
		    return;
		    }
		    else {
		    $('.item_btns-map div').removeClass('active');
		    obj.addClass('active');
		    obj_s.hide();
		    obj_s.eq(num).toggle();
		    }
		  });

		$('.item_btns-news div').click(function(){
		    obj=$(this);
		    num=obj.index();
		    obj_s=$('.tab4');
		    if (obj.hasClass('active')) {
		    return;
		    }
		    else {
		    $('.item_btns-news div').removeClass('active');
		    obj.addClass('active');
		    obj_s.hide();
		    obj_s.eq(num).toggle();
		    }
		  });


//		$('#you-region-yes').click(function() {
		$('.you-region-abs .transition').click(function() {
	        $('.you-region-abs').fadeOut();
	    });

		function region(){
			setTimeout( function(){
				 $('.you-region-abs').fadeOut();
				}, 5000 );
			}

		region();
//	     $("#city-block-click").click(function(){
	     $(".city-block").click(function(){
		    $(this).next().toggle('slow');
		     if (!$(this).hasClass('open')) {
		     		$(this).addClass('open');
		      	} else {
		    	 $(this).removeClass('open');
		    	}
		  });


	      $(".top-menu-mobile-btn").click(function(){
	    	  //console.log('test');
//			    $(this).next().toggle('slow');
		    $(this).closest('.center').find('.js-top-menu-mobile-popup_fon').toggle();
		    $(this).closest('.center').find('.top-menu-mobile-popup').toggle('slow');
		     if (!$(this).hasClass('open')) {
		     		$(this).addClass('open');
		      	} else {
		    	 $(this).removeClass('open');
		    	}
		  });

	      $(".js-top-menu-mobile-popup_fon").click(function(){
	    	  //console.log('test');
	    	  $(this).closest('.center').find('.top-menu-mobile-btn').trigger('click');


	      });



		/*("#form-phone-1").inputmask("+7 (999) 999-99-99");*/

});

$(function() {

			/*$(".faq-item-name").click(function() {
				$(this).next().toggle('slow');

				if (!$(this).hasClass('faq-item-name-active')) {
					$(this).addClass('faq-item-name-active');
				} else {
					$(this).removeClass('faq-item-name-active');
				}
			});
			$(".services-detail-price-block-item-name").click(function() {
				$(this).next().toggle('slow');

				if (!$(this).hasClass('services-detail-price-block-item-name-active')) {
					$(this).addClass('services-detail-price-block-item-name-active');
				} else {
					$(this).removeClass('services-detail-price-block-item-name-active');
				}
			});*/
		});


	    $(document).ready(function(){
	        var owl = $("#slider-index").owlCarousel({
	            items: 1,
	            slideSpeed: 500,
	            autoplay: false,
	            autoplayTimeout: 7000,
	            loop: true,
	            navigation: true,
				navText: ['<svg width="15" height="27" viewBox="0 0 15 27" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 1L1.74967 12.7792C1.34048 13.1726 1.34048 13.8274 1.74967 14.2208L14 26" stroke-width="2" stroke-linecap="round"/></svg>', '<svg width="15" height="27" viewBox="0 0 15 27" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 1L1.74967 12.7792C1.34048 13.1726 1.34048 13.8274 1.74967 14.2208L14 26" stroke-width="2" stroke-linecap="round"/></svg>'],
	            mouseDrag: true,
	             autoplayHoverPause:true,
	            singleItem: true,

	            dots: false,
	           itemsTablet: [1990, 1],
        		itemsMobile: [580, 1],
				lazyLoad: true
	        }).data('owlCarousel');

	    });

	    $(document).ready(function(){

	    	var owlwidth = 0;

	    	if($("#block-trend").length){
	    		var width = $(document).width();
	    		if(width<720 && width>450){
	    	    	owlwidth = width;
	    		}
	    	}
    		// if(owlwidth>0){
    		// 	$("#block-trend").attr('style','width:400px!important;margin:0 15%;');
    		// }
	        var owl = $("#block-trend").owlCarousel({
	            items: 4,
	            slideSpeed: 500,
	            autoplay: false,
	            autoplayTimeout: 4500,
	            loop: true,
	            navigation: true,
				navText: ['<svg width="15" height="27" viewBox="0 0 15 27" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 1L1.74967 12.7792C1.34048 13.1726 1.34048 13.8274 1.74967 14.2208L14 26" stroke-width="2" stroke-linecap="round"/></svg>', '<svg width="15" height="27" viewBox="0 0 15 27" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 1L1.74967 12.7792C1.34048 13.1726 1.34048 13.8274 1.74967 14.2208L14 26" stroke-width="2" stroke-linecap="round"/></svg>'],
	             mouseDrag: true,
	             autoplayHoverPause:true,
	            singleItem: true,
	            dots: false,
				margin: 20,
				lazyLoad: true,
				responsive: {
				  0: {
					items: 3,
					  margin: 0
				  },
				  720: {
					items: 3
				  },
				  1180: {
					items: 4
				  },
					1500: {
						items: 5
					},
				  1800: {
					items: 6
				  }
				}
	        }).data('owlCarousel');

	    	// if(owlwidth>0){
    		// 	$(".block-trend .owl-nav button.owl-prev").css({left:142});
    		// 	$(".block-trend .owl-nav button.owl-next").css({right:217});
	    	// }
	    });

	     $(document).ready(function(){
	        var owl = $("#block-new").owlCarousel({
	            items: 4,
	            slideSpeed: 500,
	            autoplay: false,
	            autoplayTimeout: 4500,
	            loop: true,
	            navigation: true,
				navText: ['<svg width="15" height="27" viewBox="0 0 15 27" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 1L1.74967 12.7792C1.34048 13.1726 1.34048 13.8274 1.74967 14.2208L14 26" stroke-width="2" stroke-linecap="round"/></svg>', '<svg width="15" height="27" viewBox="0 0 15 27" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 1L1.74967 12.7792C1.34048 13.1726 1.34048 13.8274 1.74967 14.2208L14 26" stroke-width="2" stroke-linecap="round"/></svg>'],
				mouseDrag: true,
	             autoplayHoverPause:true,
	            singleItem: true,
	            dots: false,
				margin: 20,
				lazyLoad: true,
	           responsive: {
				  0: {
					items: 3,
					  margin: 0
				  },
				  720: {
					items: 3
				  },
				  1180: {
					items: 4
				  },
				   1500: {
					   items: 5
				   },
			      1800: {
					   items: 6
				  }
				}
	        }).data('owlCarousel');

	    });

	    $(document).ready(function(){
	        var owl = $("#block-top").owlCarousel({
	            items: 4,
	            slideSpeed: 500,
	            autoplay: false,
	            autoplayTimeout: 4500,
	            loop: true,
	            navigation: true,
				navText: ['<svg width="15" height="27" viewBox="0 0 15 27" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 1L1.74967 12.7792C1.34048 13.1726 1.34048 13.8274 1.74967 14.2208L14 26" stroke-width="2" stroke-linecap="round"/></svg>', '<svg width="15" height="27" viewBox="0 0 15 27" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M14 1L1.74967 12.7792C1.34048 13.1726 1.34048 13.8274 1.74967 14.2208L14 26" stroke-width="2" stroke-linecap="round"/></svg>'],
				mouseDrag: true,
	             autoplayHoverPause:true,
	            singleItem: true,
	            dots: false,
				margin: 20,
				lazyLoad: true,
	           responsive: {
				  0: {
					items: 3,
					  margin: 0
				  },
				  720: {
					items: 3
				  },
				  1180: {
					items: 4
				  },
				   1500: {
					   items: 5
				   },
			      1800: {
					   items: 6
				  }
				}
	        }).data('owlCarousel');

	    });


	     $(document).ready(function(){
			 if (window.location.search.includes('home_wide')) {
				 $("#brand-index").owlCarousel({
					 items: 12,
					 slideSpeed: 500,
					 autoplay: false,
					 autoplayTimeout: 4500,
					 loop: true,
					 navigation: true,
					 mouseDrag: true,
					 autoplayHoverPause:true,
					 singleItem: true,
					 dots: false,
					 margin: 28,
					 responsive: {
						 0: {
							 items: 2
						 },
						 720: {
							 items: 5
						 },
						 980: {
							 items: 6
						 },
						 1180: {
							 items: 8
						 },
						 1860: {
							 items: 12
						 }
					 }
				 }).data('owlCarousel');
			 } else {
				 var owl = $("#brand-index").owlCarousel({
					 items: 8,
					 slideSpeed: 500,
					 autoplay: false,
					 autoplayTimeout: 4500,
					 loop: true,
					 navigation: true,
					 mouseDrag: true,
					 autoplayHoverPause:true,
					 singleItem: true,
					 dots: false,
					 margin: 28,
					 responsive: {
						 0: {
							 items: 2
						 },
						 720: {
							 items: 5
						 },
						 980: {
							 items: 6
						 },
						 1180: {
							 items: 8
						 }
					 }
				 }).data('owlCarousel');
			 }
	    });

	     $(document).ready(function(){
	        var owl = $("#block-news").owlCarousel({
	            items: 4,
	            slideSpeed: 500,
	            autoplay: true,
	            autoplayTimeout: 4500,
	            loop: true,
	            navigation: true,
	            mouseDrag: true,
	             autoplayHoverPause:true,
	            singleItem: true,
	            dots: false,
				margin: 20,
				responsive: {
				  0: {
					items: 2
				  },
				  720: {
					items: 3
				  },
				  980: {
					items: 4
				  },
					1500: {
						items: 5
					},
				  1800: {
					items: $('body').hasClass('design_v2') ? 6 : 4
				  }
				}
	        }).data('owlCarousel');

	    });

	      $(document).ready(function(){
	        var owl = $("#block-stock").owlCarousel({
	            items: 4,
	            slideSpeed: 500,
	            autoplay: true,
	            autoplayTimeout: 4500,
	            loop: true,
	            navigation: true,
	             mouseDrag: true,
	             autoplayHoverPause:true,
	            singleItem: true,
	            dots: false,
				margin: 20,
	           responsive: {
				  0: {
					items: 2
				  },
				  720: {
					items: 3
				  },
				  980: {
					items: 4
				  },
				   1500: {
					   items: 5
				   },
				  1800: {
					items: $('body').hasClass('design_v2') ? 6 : 4
				  }
				}
	        }).data('owlCarousel');

	    });


	        $(document).ready(function(){
	        var owl = $("#block-articles").owlCarousel({
	            items: 4,
	            slideSpeed: 500,
	            autoplay: true,
	            autoplayTimeout: 4500,
	            loop: true,
	            navigation: true,
	            mouseDrag: true,
	             autoplayHoverPause:true,
	            singleItem: true,
	            dots: false,
				margin: 20,
	           responsive: {
				  0: {
					items: 2
				  },
				  720: {
					items: 3
				  },
				  980: {
					items: 4
				  },
				   1500: {
					   items: 5
				   },
				  1800: {
					items: 6
				  }
				}
	        }).data('owlCarousel');

	    });

	      $(document).ready(function(){
	        var owl = $("#responses-index").owlCarousel({
	            items: 5,
	            slideSpeed: 500,
	            autoplay: true,
	            autoplayTimeout: 4500,
	            loop: true,
	            autoplayHoverPause: true,
	            navigation: true,
	            mouseDrag: true,
	             autoplayHoverPause:true,
	            singleItem: true,
	            dots: false,
				 responsive: {
				  0: {
					items: 1
				  },
				  440: {
					items: 4
				  },
				  1610: {
					items: 5
				  }
				}
	        }).data('owlCarousel');

	    });

	        $(document).ready(function(){
	        var owl = $("#showroom-photo").owlCarousel({
	            items: 6,
	            slideSpeed: 500,
	            autoplay: false,
	            autoplayTimeout: 4500,
	            loop: true,
	            autoplayHoverPause: false,
	            navigation: true,
	            mouseDrag: false,
	            singleItem: true,
	            dots: false,
	          	responsive: {
				  0: {
					items: 2
				  },
				  440: {
					items: 3
				  },
				  720: {
					items: 5
				  },
				  1180: {
					items: 6
				  }
				}
	        }).data('owlCarousel');

	    });

		$(document).ready(function(){

			if($('.topmenu').length){

				var offset = $('.topmenu').offset();
				var top_point = offset.top;

				var window_width = $(window).width();

				if(window_width>1200 && window.location.search.includes('old_header')){

					$(window).scroll(function() {
						if ($(this).scrollTop() > top_point){
							$('#header_scroll').fadeIn();
							$('.compilation_head_fixed').addClass('fixed');
						}
						else{
							$('#header_scroll').fadeOut();
							$('.compilation_head_fixed').removeClass('fixed');
						}
					});
				}
			}

			if($('.header-cart .header-cart-count').length) {
				var cart_count = $('.header-cart .header-cart-count').html();
				$('#header_scroll .is_cart_count').html(cart_count);

				var cart_count_num = cart_count.split(' ');
				cart_count_num = cart_count_num[0];
				if ($('.header_mobile_cart .top-basket-count').length) {
					$('.header_mobile_cart .top-basket-count').html(cart_count_num);
				}
			}

			if($('.header-basket__quantity').length) {
				$('.header_mobile_cart .top-basket-count').html($('.header-basket__quantity').text());
			}

			if($('.header-cart .header-cart-sum').length){
				var cart_sum = $('.header-cart .header-cart-sum').html();

				$('#header_scroll .is_cart_sum').html(cart_sum);
			}

			if($("#header_scroll .is_menu .is_button").length){
				$("#header_scroll .is_menu .is_button").css({'cursor':'pointer'});
			}
			$("#header_scroll .is_menu .is_button").on('click',function(){
				$('#header_scroll .js_menu_oboi').toggle();
				$('#header_scroll .js_menu_oboi .topmenu-left').toggle();

			});

			// для новой шапки
			if ($('.header-top .header-basket__quantity').length) {
				let cartItemsCount = $('.header-top .header-basket__quantity').text();
				if (!isNaN(cartItemsCount)) {
					let lastDigit = cartItemsCount % 10;
					let wordEnd = '';
					if (lastDigit > 1 && lastDigit < 5)
						wordEnd = 'а';
					else if (lastDigit > 4)
						wordEnd = 'ов';

					$('#header_scroll .is_cart_count').html(cartItemsCount + ' товар' + wordEnd);
				}
			}

			if ($('.header-top .header-basket__total').length) {
				$('#header_scroll .is_cart_sum').html($('.header-top .header-basket__total').html());
			}
//
//			$("#header_scroll .js_menu_oboi").on('mouseover',function(){
//				console.log('test');
//				$('#header_scroll .js_menu_oboi').toggle();
//				$('#header_scroll .js_menu_oboi a[href="/oboi/"]').closest('.topmenu-left').toggle();
//			});
		});

		$(document).ready(function(){
			$('a[href=#opencoupon]').on('click',function(){
				if($('body').find('#weekendOrderForm').length){
					$('.overlay-3, .weekend_wrap, #weekendOrderForm').show();
				} else {
			    	$.ajax({
			    		url: '/ajax/form/weekend_order_new.php?weekend&new',
			    		type: 'post',
			    		data: {
			    			'action': '',
			    			'id': ''
			    		},
			    		beforeSend: function (data) {
			    		},
			    		success: function (data) {
			    			$('body').append(data);
			    		}
			    	});
				}
			});

		});
		$(document).ready(function(){
			//if(window.location.search.indexOf('test')>0){
				var w_width = $(window).width();
				if(w_width<=980 && $('.top-ya-rang-item').length){
					var obj = $('.top-ya-rang-item');

					obj.on('click',function(){
						var html = $(this).find('.top-ya-rang-item-popap').html();
						$('.top-ya-rang').find('.js_msi').show().find('.js_msi_block').html(html);
					});
					$('.js_msi .js_close_b').on('click',function(){
						$(this).closest('.js_msi').hide();
					});
				}

			//}



			sliderAlign();
			window.addEventListener('resize', sliderAlign);
		});


		/* 2022.10.20*/





		/* 2023.08.21*/

	$(document).ready(function(){
		if ('loading' in HTMLImageElement.prototype) {
			var pathname = document.location.pathname;
			if(
				pathname=='/catalog/as-creation/'
				||pathname=='/catalog/andrea-rossi/'
				||pathname=='/catalog/arlin/'
				||pathname=='/catalog/Rasch/'
			){
				$('img').attr('loading','lazy');
				console.log(pathname);
				console.log('loading');
				console.log('lazy');
			}
		} else {

		}

		$('.interior-inner').click(function() {
			ym(15883444,'reachGoal','clckint');
		});
	});


document.addEventListener('DOMContentLoaded', () => {
	let metroBtn = document.querySelector('.top-mobile__metro-btn');
	if (metroBtn) {
		metroBtn.addEventListener('click', () => {
			let showroomsList = document.querySelector('.header-showrooms-mobile');
			if (showroomsList)
				showroomsList.classList.toggle('show');
		});
	}

	let changeViewButton = document.querySelector('.change-view-button');
	if (changeViewButton) {
		changeViewButton.addEventListener('click', function() {
			let container = document.querySelector('.catalog-section .items-container');
			if (container) {
				container.classList.toggle('one-item');
				this.classList.toggle('two-items');
			}
		});
	}
});


function sliderAlign() {
	if (window.innerWidth > 720)
		return;

	let sliderContainer = document.querySelector('.tab-block-catalog-index');
	let blocksTrend = document.querySelectorAll('.block-trend');

	let currentBlockId = 0;
	document.querySelectorAll('.tab-block-catalog-index .tab_btn').forEach((btn, i) => {
		if (btn.classList.contains('active')) {
			currentBlockId = i;
		}
	});

	if (sliderContainer && blocksTrend.length) {
		let leftMargin = (sliderContainer.offsetWidth - (blocksTrend[currentBlockId].offsetWidth - 10)) / 2;

		blocksTrend.forEach((blockTrend) => {
			blockTrend.style.marginLeft = leftMargin + 'px';
		});

		document.querySelectorAll('.tab-block-catalog-index .block-trend .owl-nav').forEach((nav) => {
			nav.style.width = sliderContainer.offsetWidth + 'px';
			nav.style.marginLeft = -leftMargin + 'px';
		});
	}
}

document.addEventListener('DOMContentLoaded', () => {
	$('.bx-filter').click(function() {
		ym(15883444,'reachGoal','click-filtr');
	});
});


function copyToClipboard(text, containerSelector = 'body') {
	const textArea = document.createElement("textarea");
	textArea.value = text;

	//let basketShareBtn = document.querySelector('.js-basket-share');
	let container = document.querySelector(containerSelector);
	container.appendChild(textArea);
	textArea.focus();
	textArea.select();

	try {
		document.execCommand('copy');
	} catch (err) {
		console.error('Unable to copy to clipboard', err);
	}

	container.removeChild(textArea);
}

document.addEventListener('DOMContentLoaded', () => {
	//обновление кол-ва товаров в корзине в header
	fetch('/ajax/cart/get_count.php')
		.then(response => response.json())
		.then(data => {
			if (data.quantity !== undefined) {
				document.querySelectorAll('[data-basket-quantity]')
					.forEach(quantityContainer=> quantityContainer.innerText = data.quantity);
			}
		});

	//обновление кол-ва товаров в сравнении в header
	fetch('/ajax/compare/get_count.php')
		.then(response => response.json())
		.then(data => {
			if (data.quantity !== undefined) {
				document.querySelectorAll('[data-compare-count]')
					.forEach(quantityContainer=> quantityContainer.innerText = data.quantity);
			}
		});

	//обновление кол-ва просмотренных товаров в header
	fetch('/ajax/viewed_products/get_count.php')
		.then(response => response.json())
		.then(data => {
			if (data.quantity !== undefined) {
				//console.log('viewed products quantity', data.quantity);
				document.querySelectorAll('[data-viewed-count]')
					.forEach(quantityContainer=> quantityContainer.innerText = data.quantity);
			}
		});
});

document.addEventListener('DOMContentLoaded', () => {
	const lazyImages = document.querySelectorAll('[data-lazy-src]');

	const lazyImagesObserver = new IntersectionObserver((entries, observer) => {
		entries.forEach((entry) => {
			if (entry.isIntersecting) {
				//console.log(entry.target.tagName);
				if (entry.target.tagName === 'IMG')
					entry.target.src = entry.target.dataset.lazySrc;
				else
					entry.target.style.backgroundImage = `url(${entry.target.dataset.lazySrc})`;

				observer.unobserve(entry.target);
			}
		});
	});

	lazyImages.forEach((image) => lazyImagesObserver.observe(image));
});



